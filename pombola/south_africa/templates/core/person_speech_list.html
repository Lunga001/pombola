{% load firstof from future %}
{% load speech_utils %}

{% comment %}

  Arguments:

    speechlist - an iterable containting all the speeches to show

    section_url - the name of the url to use when linking to sections. Default is 'speeches:section-view'.

    parent_title - boolean, whether to use the parent section's title, rather
                   than own (useful for Question display) (Default is false)

    ifempty - a string shown if there are no speeches to show.
              (Default is "No speeches found")

{% endcomment %}

<ul class="unstyled speeches">
    {% for speech in speechlist %}
    <li>
        <p>
            <span class="speech-title">
                <a class="speech-url" href="{% url 'speeches:section-view' speech.section.get_path %}#s{{ speech.id }}">
                    {% if parent_title %}
                        {{ speech.section.parent.title }}
                    {% else %}
                        {{ speech.section.title }}
                    {% endif %}
                </a>
                {% with house_name=speech.section.question.house_name %}
                  {% if house_name %}
                    <span class="speech-house">
                      {{ house_name }}
                    </span>
                  {% endif %}
                {% endwith %}
            </span>
            <span class="speech-date">
                {{ speech.start_date }}
            </span>
        </p>
        <div class="speech-text">
            {{ speech.text|bleach|truncatewords_html:50 }}
        </div>
    </li>
    {% empty %}
        {% firstof ifempty "No speeches found" %}
    {% endfor %}
</ul>
